[
  {
    "id": "listView1",
    "component": "ListView",
    "attributes": {
      "bindConnectMetadata": {},
      "connectorMethod": {},
      ":dataSourceData": "$w.page.dataset.state.lastWatch",
      "dataSourceType": "expression",
      "datasource": {
        "name": "playlet_user_watch_hfhc6pa",
        "type": "datamodal",
        "extra": {
          "params": {},
          "viewId": "view-4z390wpw00",
          "methodName": "wedaGetRecords"
        }
      },
      "emptyText": "暂无内容",
      "enableTotal": true,
      "exprToFieldsSchema": "41713574",
      "isSetStatus": true,
      "isSupportApis": false,
      "loadCompletedText": "",
      "orderType": "asc",
      "pageSize": 10,
      "pagination": "bottomLoad",
      "queryCondition": [],
      "template": "imageTextList",
      ":total": "$w.page.dataset.state.lastWatchTotal",
      "style": {
        "padding": "8PX 16PX"
      }
    },
    "items": [
      {
        "id": "repeater1",
        "component": "Repeater",
        "attributes": {
          ":data": "$w.listView1.records",
          "forIndex": "index_repeater1",
          "forItem": "item_repeater1",
          "key": "_id",
          "suffix": "repeater1"
        },
        "items": [
          {
            "id": "container1",
            "component": "Container",
            "attributes": {
              "style": {
                "width": "100%",
                "display": "flex",
                "padding": "6px",
                "position": "relative",
                "boxSizing": "border-box",
                "background": "rgb(255, 255, 255)",
                "borderRadius": "6px",
                "marginBottom": "12px"
              }
            },
            "items": [
              {
                "id": "container2",
                "component": "Container",
                "attributes": {
                  "style": {
                    "width": "80PX",
                    "height": "100%",
                    "margin": "0px 24 0px 0px",
                    "overflow": "hidden",
                    "position": "relative",
                    "borderRadius": "4px"
                  }
                },
                "items": [
                  {
                    "id": "image1",
                    "component": "WdImage",
                    "attributes": {
                      "alt": "[图片]",
                      "fit": "cover",
                      ":src": "$w.item_repeater1.video_id?.front_pic_addr || 'https://lowcode-4gs26nnz095f6f4d-1307578329.tcloudbaseapp.com/resources/2023-11/lowcode-1498431'",
                      "style": {
                        "width": "87px",
                        "height": "116px",
                        "borderRadius": "6px"
                      }
                    },
                    "directives": {
                      ":if": true
                    },
                    "extra": {
                      "attributeExtraData": {}
                    }
                  }
                ],
                "listeners": [
                  {
                    "id": "w092pfsa9ip",
                    "eventName": "tap",
                    "type": "general-func",
                    "handler": {
                      "name": "iife",
                      "module": "general-func",
                      ":code": "({event}) => {\n  $w.app.common.getPlayerManager().navigateToPlayer({\n    dramaId: $w.item_repeater1?.video_id?.drama_id\n  })\n}",
                      "params": {}
                    },
                    "isCapturePhase": false,
                    "noPropagation": false
                  }
                ],
                "directives": {
                  ":if": true
                },
                "extra": {}
              },
              {
                "id": "container3",
                "component": "Container",
                "attributes": {
                  "style": {
                    "gap": "4PX",
                    "flex": 1,
                    "width": "146PX",
                    "display": "flex",
                    "wordBreak": "break-all",
                    "alignItems": "flex-start",
                    "flexDirection": "column",
                    "justifyContent": "center"
                  }
                },
                "items": [
                  {
                    "id": "text1",
                    "component": "WdText",
                    "attributes": {
                      "level": "title-8",
                      "maxLines": "1",
                      ":text": "$w.item_repeater1.video_id?.main_name || '-'",
                      "style": {
                        "color": "var(--wd-color-text-default)",
                        "width": "146PX",
                        "marginBottom": "8px"
                      },
                      "class": "ellipsis"
                    },
                    "directives": {
                      ":if": true
                    },
                    "extra": {
                      "attributeExtraData": {}
                    }
                  },
                  {
                    "id": "container11",
                    "component": "Container",
                    "attributes": {
                      "style": {
                        "display": "flex",
                        "alignItems": "center"
                      }
                    },
                    "items": [
                      {
                        "id": "icon1",
                        "component": "WdIcon",
                        "attributes": {
                          "name": "td:video",
                          "style": {
                            "color": "#97A3B7",
                            "fontSize": "16px",
                            "marginRight": 4
                          }
                        },
                        "directives": {
                          ":if": true
                        },
                        "extra": {
                          "staticResourceAttribute": [
                            "src"
                          ],
                          "attributeExtraData": {}
                        }
                      },
                      {
                        "id": "text2",
                        "component": "WdText",
                        "attributes": {
                          "level": "body-md",
                          "maxLines": "2",
                          "overflow": true,
                          "text": "观看至",
                          "style": {
                            "color": "rgb(0, 0, 0)",
                            "marginRight": 4
                          }
                        },
                        "directives": {
                          ":if": true
                        },
                        "extra": {
                          "attributeExtraData": {}
                        }
                      },
                      {
                        "id": "text3",
                        "component": "WdText",
                        "attributes": {
                          "level": "body-md",
                          "maxLines": "2",
                          "overflow": true,
                          ":text": "`第 ${$w.item_repeater1?.watch_section_id?.series_number || '-'} 集`",
                          "style": {
                            "color": "var(--wd-color-error)"
                          }
                        },
                        "directives": {
                          ":if": true
                        },
                        "extra": {
                          "attributeExtraData": {}
                        }
                      }
                    ],
                    "directives": {
                      ":if": true
                    },
                    "extra": {}
                  },
                  {
                    "id": "container12",
                    "component": "Container",
                    "attributes": {
                      "style": {
                        "display": "flex",
                        "alignItems": "center"
                      }
                    },
                    "items": [
                      {
                        "id": "icon5",
                        "component": "WdIcon",
                        "attributes": {
                          "name": "td:refresh",
                          "style": {
                            "color": "#97A3B7",
                            "fontSize": "16px",
                            "marginRight": 4
                          }
                        },
                        "directives": {
                          ":if": true
                        },
                        "extra": {
                          "staticResourceAttribute": [
                            "src"
                          ],
                          "attributeExtraData": {}
                        }
                      },
                      {
                        "id": "text9",
                        "component": "WdText",
                        "attributes": {
                          "level": "body-md",
                          "maxLines": "2",
                          "overflow": true,
                          ":text": "$w.item_repeater1.video_id?.status === '1' ? '更新至' : '已完结'",
                          "style": {
                            "color": "var(--wd-color-text-placeholder)",
                            "marginRight": "4px"
                          }
                        },
                        "directives": {
                          ":if": true
                        },
                        "extra": {
                          "attributeExtraData": {}
                        }
                      },
                      {
                        "id": "text10",
                        "component": "WdText",
                        "attributes": {
                          "level": "body-md",
                          "maxLines": "2",
                          "overflow": true,
                          ":text": "`${$w.item_repeater1.video_id?.status === '1' ? '第' : '共'} ${$w.item_repeater1.video_id?.renew_count || '-'} 集`",
                          "style": {
                            "color": "rgba(0, 0, 0, 0.90)"
                          }
                        },
                        "directives": {
                          ":if": true
                        },
                        "extra": {
                          "attributeExtraData": {}
                        }
                      }
                    ],
                    "directives": {
                      ":if": true
                    },
                    "extra": {}
                  }
                ],
                "listeners": [
                  {
                    "id": "wzl49wc9g1n",
                    "eventName": "tap",
                    "type": "general-func",
                    "handler": {
                      "name": "iife",
                      "module": "general-func",
                      ":code": "({event}) => {\n  $w.app.common.getPlayerManager().navigateToPlayer({\n    dramaId: $w.item_repeater1?.video_id?.drama_id\n  })\n}",
                      "params": {}
                    },
                    "isCapturePhase": false,
                    "noPropagation": false
                  }
                ],
                "directives": {
                  ":if": true
                },
                "extra": {}
              },
              {
                "id": "container4",
                "component": "Container",
                "attributes": {
                  "style": {
                    "width": "24PX",
                    "height": "24PX",
                    "margin": "auto 20px auto 16PX",
                    "display": "flex",
                    "opacity": 0.9,
                    "alignItems": "center",
                    "justifyContent": "center"
                  }
                },
                "items": [
                  {
                    "id": "icon6",
                    "component": "WdIcon",
                    "attributes": {
                      "name": "td:delete",
                      "size": "xs",
                      "sizeSelfAdaptive": true,
                      "style": {
                        "color": "rgb(254, 68, 68)",
                        "textAlign": "right"
                      }
                    },
                    "listeners": [
                      {
                        "id": "wk9waihg7ef",
                        "eventName": "tap",
                        "type": "platform",
                        "handler": {
                          "name": "showModal",
                          "module": "platform",
                          "params": {
                            "cancelColor": "#000000",
                            "cancelText": "取消",
                            "confirmColor": "#576B95",
                            "confirmText": "确认",
                            "content": "是否确认删除观看历史记录",
                            "showCancel": true,
                            "title": ""
                          }
                        },
                        "isCapturePhase": false,
                        "noPropagation": false
                      },
                      {
                        "id": "wumcq3v4hom",
                        "eventName": "wk9waihg7ef.confirm",
                        "type": "platform",
                        "handler": {
                          "name": "cloud.callDataSource",
                          "module": "platform",
                          "params": {
                            "dataSourceName": "playlet_user_watch_hfhc6pa",
                            "methodName": "wedaDeleteV2",
                            "options": {
                              "showToast": false,
                              "showLoading": true
                            },
                            "outputs": {},
                            "params": {
                              "select": {
                                "$master": true
                              },
                              ":filter": "{\n \"where\": {\n  \"$and\": [\n   {\n    \"$and\": [\n     {\n      \"_id\": {\n       \"$eq\": $w.item_repeater1._id\n      }\n     }\n    ]\n   }\n  ]\n },\n \"relateWhere\": {}\n}"
                            }
                          }
                        },
                        "isCapturePhase": false,
                        "noPropagation": false
                      },
                      {
                        "id": "wafjftuk4xl",
                        "eventName": "wumcq3v4hom.success",
                        "type": "rematch",
                        "handler": {
                          "name": "lastWatchSuccess",
                          "module": "watch-history",
                          "params": {
                            ":target": "({deleteIndex:$w.index_repeater1 })"
                          }
                        },
                        "isCapturePhase": false,
                        "noPropagation": false
                      }
                    ],
                    "directives": {
                      ":if": true
                    },
                    "extra": {
                      "staticResourceAttribute": [
                        "src"
                      ],
                      "attributeExtraData": {}
                    }
                  }
                ],
                "directives": {
                  ":if": true
                },
                "extra": {}
              }
            ],
            "directives": {
              ":if": true
            },
            "extra": {}
          }
        ],
        "directives": {
          ":if": true
        },
        "extra": {
          "attributeExtraData": {}
        }
      }
    ],
    "listeners": [
      {
        "id": "we9bknajjcq",
        "eventName": "onPagingChange",
        "type": "rematch",
        "handler": {
          "name": "getLastWatch",
          "module": "watch-history",
          "params": {}
        },
        "isCapturePhase": false,
        "noPropagation": false
      }
    ],
    "directives": {
      ":if": true
    },
    "scopedStyle": ":scope .weda-list-view__content {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: flex-start;\n}",
    "extra": {
      "attributeExtraData": {}
    }
  }
]